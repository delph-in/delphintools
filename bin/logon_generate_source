#!/bin/bash

# generate from a profile and store results in <iikae>
# assumes <source> exists with mrs parse results
logon_generate_source () {
	source=$1
	generate=$2

	cat 2>&1 <<- GENERATE
		(lkb::read-script-file-aux "$grammarscript")
		(lkb::index-for-generator)
		(tsdb::tsdb :home "$TREEBANK/$name")
		(tsdb::tsdb :list)
	GENERATE
	
	if [ -n "$limit" ]; then
		# need to make a separate limit for generation results
		j=0
		while [ $j -lt $limit ];
		do
			logon_setup_profile $name/imrs/$j
			cat 2>&1 <<- GENERATE
				(tsdb::tsdb-do-process "imrs/$j"
				  :condition "result-id=$j"
	                          :type :generate :overwrite t
	                          :gold "smrs")
			GENERATE
			j=`expr $j + 1`
		done
	fi
}

logon_generate_source $*
